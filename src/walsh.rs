//! Walsh code tables for CuaimaCrypt.
//!
//! Contains the 128-entry Walsh code table used by the CuaimaCrypt
//! orchestrator for spread-spectrum XOR operations on 128-bit blocks.
//! Each entry is a pair of `i64` values representing the two 64-bit
//! halves of a 128-bit Walsh code.

/// Walsh code table for the CuaimaCrypt cipher.
///
/// 128 entries, each with two `i64` values representing a 128-bit code.
/// Index 0 is the identity (both zeros). Indices 1-127 are used for
/// spread-spectrum XOR during encryption.
#[rustfmt::skip]
pub(crate) const WALSH_CODES: [[i64; 2]; 128] = [
    // [0]
    [0, 0],
    [-3074457345618260000, -3074457345618260000],
    [-5534023222112870000, -5534023222112870000],
    [7378697629483820000, 7378697629483820000],
    [-8138269444283630000, -8138269444283630000],
    [6510615555426900000, 6510615555426900000],
    [4340410370284600000, 4340410370284600000],
    [-1627653888856720000, -1627653888856720000],
    // [8]
    [-9151594822560190000, -9151594822560190000],
    [6172840429334710000, 6172840429334710000],
    [3732415143318660000, 3732415143318660000],
    [-1830318964512040000, -1830318964512040000],
    [1148435428713440000, 1148435428713440000],
    [-2691645536047110000, -2691645536047110000],
    [-4844961964884800000, -4844961964884800000],
    [7608384715226510000, 7608384715226510000],
    // [16]
    [-9223090566172970000, -9223090566172970000],
    [6149008514797120000, 6149008514797120000],
    [3689517697151000000, 3689517697151000000],
    [-1844618113234590000, -1844618113234590000],
    [1085350949055100000, 1085350949055100000],
    [-2712673695933230000, -2712673695933230000],
    [-4882812652679810000, -4882812652679810000],
    [7595767819294840000, 7595767819294840000],
    // [24]
    [72056494543077100, 72056494543077100],
    [-3050438514103900000, -3050438514103900000],
    [-5490789325387020000, -5490789325387020000],
    [7393108928392440000, 7393108928392440000],
    [-8074690184392680000, -8074690184392680000],
    [6531808642057220000, 6531808642057220000],
    [4378557926219170000, 4378557926219170000],
    [-1614938036878540000, -1614938036878540000],
    // [32]
    [-9223372032559810000, -9223372032559810000],
    [6148914692668170000, 6148914692668170000],
    [3689348817318890000, 3689348817318890000],
    [-1844674406511960000, -1844674406511960000],
    [1085102596360830000, 1085102596360830000],
    [-2712756480164650000, -2712756480164650000],
    [-4882961664296370000, -4882961664296370000],
    [7595718148755990000, 7595718148755990000],
    // [40]
    [71777218556133100, 71777218556133100],
    [-3050531606099550000, -3050531606099550000],
    [-5490956890979190000, -5490956890979190000],
    [7393053073195050000, 7393053073195050000],
    [-8074936604381160000, -8074936604381160000],
    [6531726502061060000, 6531726502061060000],
    [4378410074226080000, 4378410074226080000],
    [-1614987320876230000, -1614987320876230000],
    // [48]
    [281474976645120, 281474976645120],
    [-3074363520626040000, -3074363520626040000],
    [-5533854337126880000, -5533854337126880000],
    [7378753924479150000, 7378753924479150000],
    [-8138021084010120000, -8138021084010120000],
    [6510698342184740000, 6510698342184740000],
    [4340559386448710000, 4340559386448710000],
    [-1627604216802020000, -1627604216802020000],
    // [56]
    [-9151315538050290000, -9151315538050290000],
    [6172933524171350000, 6172933524171350000],
    [3732582714024600000, 3732582714024600000],
    [-1830263107610060000, -1830263107610060000],
    [1148681856222170000, 1148681856222170000],
    [-2691563393544200000, -2691563393544200000],
    [-4844814108379560000, -4844814108379560000],
    [7608434000728250000, 7608434000728250000],
    // [64] â€” second half differs in column [1]
    [0, -9223372036854775808],
    [-3074457345618260000, 6148914691236520000],
    [-5534023222112870000, 3689348814741910000],
    [7378697629483820000, -1844674407370960000],
    [-8138269444283630000, 1085102592571150000],
    [6510615555426900000, -2712756481427880000],
    [4340410370284600000, -4882961666570180000],
    [-1627653888856720000, 7595718147998050000],
    // [72]
    [-9151594822560190000, 71777214294589700],
    [6172840429334710000, -3050531607520060000],
    [3732415143318660000, -5490956893536110000],
    [-1830318964512040000, 7393053072342740000],
    [1148435428713440000, -8074936608141340000],
    [-2691645536047110000, 6531726500807660000],
    [-4844961964884800000, 4378410071969970000],
    [7608384715226510000, -1614987321628270000],
    // [80]
    [-9223090566172970000, 281470681808895],
    [6149008514797120000, -3074363522057660000],
    [3689517697151000000, -5533854339703780000],
    [-1844618113234590000, 7378753923620180000],
    [1085350949055100000, -8138021087799680000],
    [-2712673695933230000, 6510698340921550000],
    [-4882812652679810000, 4340559384174970000],
    [7595767819294840000, -1627604217559940000],
    // [88]
    [72056494543077100, -9151315542311700000],
    [-3050438514103900000, 6172933522750880000],
    [-5490789325387020000, 3732582711467760000],
    [7393108928392440000, -1830263108462340000],
    [-8074690184392680000, 1148681852462100000],
    [6531808642057220000, -2691563394797560000],
    [4378557926219170000, -4844814110635600000],
    [-1614938036878540000, 7608433999976240000],
    // [96]
    [-9223372032559810000, 4294967295],
    [6148914692668170000, -3074457344186600000],
    [3689348817318890000, -5534023219535890000],
    [-1844674406511960000, 7378697630342810000],
    [1085102596360830000, -8138269440493950000],
    [-2712756480164650000, 6510615556690130000],
    [-4882961664296370000, 4340410372558410000],
    [7595718148755990000, -1627653888098790000],
    // [104]
    [71777218556133100, -9151594818298640000],
    [-3050531606099550000, 6172840430755230000],
    [-5490956890979190000, 3732415145875590000],
    [7393053073195050000, -1830318963659730000],
    [-8074936604381160000, 1148435432473620000],
    [6531726502061060000, -2691645534793720000],
    [4378410074226080000, -4844961962628690000],
    [-1614987320876230000, 7608384715978550000],
    // [112]
    [281474976645120, -9223090561878130000],
    [-3074363520626040000, 6149008516228730000],
    [-5533854337126880000, 3689517699727900000],
    [7378753924479150000, -1844618112375630000],
    [-8138021084010120000, 1085350952844660000],
    [6510698342184740000, -2712673694670040000],
    [4340559386448710000, -4882812650406070000],
    [-1627604216802020000, 7595767820052750000],
    // [120]
    [-9151315538050290000, 72056498804490500],
    [6172933524171350000, -3050438512683430000],
    [3732582714024600000, -5490789322830170000],
    [-1830263107610060000, 7393108929244720000],
    [1148681856222170000, -8074690180632600000],
    [-2691563393544200000, 6531808643310570000],
    [-4844814108379560000, 4378557928475210000],
    [7608434000728250000, -1614938036126520000],
];

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_walsh_table_size() {
        assert_eq!(WALSH_CODES.len(), 128);
    }

    #[test]
    fn test_walsh_index_zero_is_identity() {
        assert_eq!(WALSH_CODES[0][0], 0);
        assert_eq!(WALSH_CODES[0][1], 0);
    }

    #[test]
    fn test_walsh_first_half_column1_matches_column0() {
        // For indices 0-63, column 0 and column 1 have the same values
        for i in 0..64 {
            assert_eq!(
                WALSH_CODES[i][0], WALSH_CODES[i][1],
                "Mismatch at index {} between columns",
                i
            );
        }
    }

    #[test]
    fn test_walsh_second_half_column1_differs() {
        // For indices 64-127, column 1 differs from column 0
        let mut any_different = false;
        for i in 64..128 {
            if WALSH_CODES[i][0] != WALSH_CODES[i][1] {
                any_different = true;
                break;
            }
        }
        assert!(any_different, "Second half columns should differ");
    }

    #[test]
    fn test_walsh_known_values() {
        assert_eq!(WALSH_CODES[64][1], -9223372036854775808); // Long.MIN_VALUE
        assert_eq!(WALSH_CODES[96][1], 4294967295); // 0xFFFFFFFF
    }
}
